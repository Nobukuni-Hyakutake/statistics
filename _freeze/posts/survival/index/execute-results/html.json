{
  "hash": "4562b4ec929d6248713d6edb480aca5a",
  "result": {
    "markdown": "---\ntitle: \"生存分析\"\nauthor: \"Nobukuni Hyakutake\"\ndate: \"2023-02-13\"\ndate-format: \"iso\"\ncategories: [R]\n---\n\n\n## パッケージの読み込み\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survival)\nlibrary(tidyverse)\n```\n:::\n\n\n## データの読み込み\n\nライフのデータ\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndsu01<-read_csv(\"\n  life\n  28\n  30\n  32\n  30\n  25\n  27\n  24\n  23\n  29\n  29\n  29\n  31\n  38\n  33\n  32\n  29\n  30\n  18\n  28\n  28\n  24\n  23\n  28\n  29\n  27\n  26\n  28\n  28\n  28\n  27\n  \",show_col_types = FALSE\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(dsu01$life,breaks = max(dsu01$life)-min(dsu01$life)+1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## ワイブル\n\n### 確率密度関数\n\n$$\nf(t)=\\frac{m}{\\eta}\\left(\\frac{t}{\\eta}\\right)^{m-1}e^{-\\left(\\frac{t}{\\eta}\\right)^m}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweibull_d<-function(m,t,eta){\n  k<-(m/eta)*(t/eta)^(m-1)*exp(-1*((t/eta)^m))\n  return(k)}\n```\n:::\n\n\n$m=2$, $\\eta=15$の場合\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1<-2\neta1<-15\nplot(weibull_d(m1,c(1:35),eta1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### ワイブル分布に従う乱数\n\n\n::: {.cell}\n\n```{.r .cell-code}\ni<-rweibull(1000,shape = m1,scale = eta1)\nhist(i)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n乱数からワイブルのパラメーターを算出する方法：survregを使う。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt<-survreg(Surv(i)~1, dist=\"weibull\")\n```\n:::\n\n\nsurvregの結果は、上述の確率密度関数のパラメーターとして使うには換算する必要がある。\n\n$m$ \n\n\n::: {.cell}\n\n```{.r .cell-code}\n1/t$scale\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.051372\n```\n:::\n:::\n\n\n$\\eta$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp(unname(t$coefficients))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 15.54061\n```\n:::\n:::\n\n\n## R version\n\n\n::: {.cell}\n\n```{.r .cell-code}\nR.version.string\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"R version 4.2.2 (2022-10-31)\"\n```\n:::\n:::\n\n## Python\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom reliability.Fitters import Fit_Weibull_2P\nimport matplotlib.pyplot as plt\nfail_times = [\n9402.7,\n6082.4,\n13367.2,\n10644.6,\n8632.0,\n3043.4,\n12860.2,\n1034.5,\n2550.9,\n3637.1\n]\nwb = Fit_Weibull_2P(failures=fail_times)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\u001b[1m\u001b[23m\u001b[4m\u001b[49m\u001b[39mResults from Fit_Weibull_2P (95% CI):\u001b[0m\nAnalysis method: Maximum Likelihood Estimation (MLE)\nOptimizer: TNC\nFailures / Right censored: 10/0 (0% right censored) \n\nParameter  Point Estimate  Standard Error  Lower CI  Upper CI\n    Alpha         7965.97         1573.53   5408.78   11732.2\n     Beta         1.68128        0.444137    1.0018   2.82162 \n\nGoodness of fit    Value\n Log-likelihood -97.1296\n           AICc  199.973\n            BIC  198.864\n             AD   1.5487 \n```\n:::\n\n```{.python .cell-code}\nplt.show()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=864}\n:::\n:::\n\n\n[Python package reliability - Fitting a specific distribution to data](https://weibull.readthedocs.io/en/latest/examples.html#determining-beta-and-eta-values)",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}