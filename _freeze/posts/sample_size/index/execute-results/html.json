{
  "hash": "7355833a7a44628b1243da2baad9f188",
  "result": {
    "markdown": "---\ntitle: \"サンプルサイズ\"\nauthor: \"Nobukuni Hyakutake\"\ndate: \"2023-11-30\"\ndate-format: \"iso\"\ncategories: [R]\nimage: \"lake.jpeg\"\n---\n\n\n![](lake.jpeg)\n\n## power.prop.testの使い方\n\n### 第一群の母比率𝑝1=100E-6、第二群の母比率𝑝2=500E-6、第一の過誤𝛼=0.05のときの母比率の差の検定の検出力\n\nここでは、0.8の検出力に線を引く。\n\n> It is proposed here as a convention that, when the investigator has no other basis for setting the desired power value, the value .80 be used.\n\n出典: [Statistical Power Analysis for the Behavioral Sciences Second Edition](https://www.utstat.toronto.edu/~brunner/oldclass/378f16/readings/CohenPower.pdf)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,1E5,1000)\nalpha <- 0.05\np1 <- 100E-6\np2 <- 500E-6\n \npower <- power.prop.test(n = n, p1 = p1, p2 = p2, sig.level = alpha)\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nn=29423のとき\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 29423\nalpha <- 0.05\np1 <- 100E-6\np2 <- 500E-6\npower <- power.prop.test(n = n, p1 = p1, p2 = p2, sig.level = alpha)\npower$power\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7999961\n```\n:::\n:::\n\n\n### 第一群の母比率𝑝1=100E-6、第二群の母比率𝑝2=10000E-6、第一の過誤𝛼=0.05のときの母比率の差の検定の検出力\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,1E4,100)\nalpha <- 0.05\np1 <- 100E-6\np2 <- 10000E-6\n \npower <- power.prop.test(n = n, p1 = p1, p2 = p2, sig.level = alpha)\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### 観測数𝑛=10、母平均の差𝛿=0.1、標準偏差𝜎=0.05、第一の過誤𝛼=0.05のときの対応のないt検定の検出力\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,100)\nalpha <- 0.05\ndelta <- 0.1\nsd <- 0.05\n \npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha)\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### 観測数𝑛=10、母平均の差𝛿=0.01、標準偏差𝜎=0.05、第一の過誤𝛼=0.05のときの対応のないt検定の検出力\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,1e3)\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\n\npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha)\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nn=392のときの検出力\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 392\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha)\npower$power\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7985901\n```\n:::\n:::\n\n\n### 観測数𝑛=10、母平均の差𝛿=0.1、標準偏差𝜎=0.05、第一の過誤𝛼=0.05のときの対応のあるt検定の検出力\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,100)\nalpha <- 0.05\ndelta <- 0.1\nsd <- 0.05\n \npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha,type=\"paired\")\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n### 観測数𝑛=10、母平均の差𝛿=0.01、標準偏差𝜎=0.05、第一の過誤𝛼=0.05のときの対応のあるt検定の検出力\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,1e3)\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\n\npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha,type=\"paired\")\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nn=196のときの検出力\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 196\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha,type=\"paired\")\npower$power\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7956606\n```\n:::\n:::\n\n\n## サンプルサイズの計算\n\n### 割合の差の検定(カイ2乗検定)\n\n$$\nn=\\frac{\\{Z(\\alpha/2)\\sqrt{2\\overline{p}(1-\\overline{p})}+Z(\\beta)\\sqrt{p_0(1-p_0)+p_1(1-p_1)}\\}^2}{d^2}\n$$\n\n$$\n\\overline{p}=(p_0+p_1)/2\n$$\n\n#### 第一群の母比率𝑝0=100E-6、第二群の母比率𝑝1=500E-6、第一の過誤𝛼=0.05、検出力0.8としたときのサンプルサイズ\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalpha <- 0.05\np0 <- 100E-6\np1 <- 500E-6\npower<-0.8\nbeta<-1-power\nphat<-(p0+p1)/2\n((-qnorm(alpha/2)*sqrt(2*phat*(1-phat))+(-qnorm(beta)*sqrt(p0*(1-p0)+p1*(1-p1))))^2)/((p1-p0)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 29423.29\n```\n:::\n:::\n\n\n\n\n### 対応のないt検定のときのサンプルサイズ\n\n下記で計算する\n\n$$\nn=\\frac{2\\sigma^2\\{Z(\\alpha/2)+Z(\\beta)\\}^2}{d^2}\n$$\n\n#### 標準偏差0.05, 検出すべき差を0.01,検出力0.8、$\\alpha$を両側5%、検出力$1-\\beta$を80%とした場合\n\n\n::: {.cell}\n\n```{.r .cell-code}\npower<-0.8\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\n(2*(sd^2)*(-qnorm(alpha/2)+(-qnorm(1-power)))^2)/(delta^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 392.444\n```\n:::\n:::\n\n\n\n### 対応のあるt検定のときのサンプルサイズ\n\n下記で計算する\n\n$$\nn=\\frac{\\sigma^2\\{Z(\\alpha/2)+Z(\\beta)\\}^2}{d^2}\n$$\n\n#### 標準偏差0.05, 検出すべき差を0.01,検出力0.8、$\\alpha$を両側5%、検出力$1-\\beta$を80%とした場合\n\n\n::: {.cell}\n\n```{.r .cell-code}\npower<-0.8\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\n((sd^2)*(-qnorm(alpha/2)+(-qnorm(1-0.8)))^2)/(delta^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 196.222\n```\n:::\n:::\n\n\n## 参考文献\n\n- [R言語　検出力・サンプルサイズ　t検定や母比率の検定の検出力の計算](https://multivariate-statistics.com/2021/10/16/r-programming-power-sample-size/)\n- [【pythonで統計学】統計検定のサンプルサイズを計算する](https://python-man.club/sample_size/)\n- [サンプルサイズの設計](https://iss.ndl.go.jp/books/R100000002-I000011064467-00)\n- [power.t.test() : 1群または2群のt検定のパワー計算をする関数](https://clover.fcg.world/2016/06/15/5302/)\n\n## R version\n\n\n::: {.cell}\n\n```{.r .cell-code}\nR.version.string\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"R version 4.3.0 (2023-04-21)\"\n```\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}