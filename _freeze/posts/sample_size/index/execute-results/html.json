{
  "hash": "7355833a7a44628b1243da2baad9f188",
  "result": {
    "markdown": "---\ntitle: \"ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º\"\nauthor: \"Nobukuni Hyakutake\"\ndate: \"2023-11-30\"\ndate-format: \"iso\"\ncategories: [R]\nimage: \"lake.jpeg\"\n---\n\n\n![](lake.jpeg)\n\n## power.prop.testã®ä½¿ã„æ–¹\n\n### ç¬¬ä¸€ç¾¤ã®æ¯æ¯”çŽ‡ð‘1=100E-6ã€ç¬¬äºŒç¾¤ã®æ¯æ¯”çŽ‡ð‘2=500E-6ã€ç¬¬ä¸€ã®éŽèª¤ð›¼=0.05ã®ã¨ãã®æ¯æ¯”çŽ‡ã®å·®ã®æ¤œå®šã®æ¤œå‡ºåŠ›\n\nã“ã“ã§ã¯ã€0.8ã®æ¤œå‡ºåŠ›ã«ç·šã‚’å¼•ãã€‚\n\n> It is proposed here as a convention that, when the investigator has no other basis for setting the desired power value, the value .80 be used.\n\nå‡ºå…¸: [Statistical Power Analysis for the Behavioral Sciences Second Edition](https://www.utstat.toronto.edu/~brunner/oldclass/378f16/readings/CohenPower.pdf)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,1E5,1000)\nalpha <- 0.05\np1 <- 100E-6\np2 <- 500E-6\n \npower <- power.prop.test(n = n, p1 = p1, p2 = p2, sig.level = alpha)\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nn=29423ã®ã¨ã\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 29423\nalpha <- 0.05\np1 <- 100E-6\np2 <- 500E-6\npower <- power.prop.test(n = n, p1 = p1, p2 = p2, sig.level = alpha)\npower$power\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7999961\n```\n:::\n:::\n\n\n### ç¬¬ä¸€ç¾¤ã®æ¯æ¯”çŽ‡ð‘1=100E-6ã€ç¬¬äºŒç¾¤ã®æ¯æ¯”çŽ‡ð‘2=10000E-6ã€ç¬¬ä¸€ã®éŽèª¤ð›¼=0.05ã®ã¨ãã®æ¯æ¯”çŽ‡ã®å·®ã®æ¤œå®šã®æ¤œå‡ºåŠ›\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,1E4,100)\nalpha <- 0.05\np1 <- 100E-6\np2 <- 10000E-6\n \npower <- power.prop.test(n = n, p1 = p1, p2 = p2, sig.level = alpha)\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### è¦³æ¸¬æ•°ð‘›=10ã€æ¯å¹³å‡ã®å·®ð›¿=0.1ã€æ¨™æº–åå·®ðœŽ=0.05ã€ç¬¬ä¸€ã®éŽèª¤ð›¼=0.05ã®ã¨ãã®å¯¾å¿œã®ãªã„tæ¤œå®šã®æ¤œå‡ºåŠ›\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,100)\nalpha <- 0.05\ndelta <- 0.1\nsd <- 0.05\n \npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha)\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### è¦³æ¸¬æ•°ð‘›=10ã€æ¯å¹³å‡ã®å·®ð›¿=0.01ã€æ¨™æº–åå·®ðœŽ=0.05ã€ç¬¬ä¸€ã®éŽèª¤ð›¼=0.05ã®ã¨ãã®å¯¾å¿œã®ãªã„tæ¤œå®šã®æ¤œå‡ºåŠ›\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,1e3)\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\n\npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha)\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nn=392ã®ã¨ãã®æ¤œå‡ºåŠ›\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 392\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha)\npower$power\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7985901\n```\n:::\n:::\n\n\n### è¦³æ¸¬æ•°ð‘›=10ã€æ¯å¹³å‡ã®å·®ð›¿=0.1ã€æ¨™æº–åå·®ðœŽ=0.05ã€ç¬¬ä¸€ã®éŽèª¤ð›¼=0.05ã®ã¨ãã®å¯¾å¿œã®ã‚ã‚‹tæ¤œå®šã®æ¤œå‡ºåŠ›\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,100)\nalpha <- 0.05\ndelta <- 0.1\nsd <- 0.05\n \npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha,type=\"paired\")\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n### è¦³æ¸¬æ•°ð‘›=10ã€æ¯å¹³å‡ã®å·®ð›¿=0.01ã€æ¨™æº–åå·®ðœŽ=0.05ã€ç¬¬ä¸€ã®éŽèª¤ð›¼=0.05ã®ã¨ãã®å¯¾å¿œã®ã‚ã‚‹tæ¤œå®šã®æ¤œå‡ºåŠ›\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- seq(1,1e3)\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\n\npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha,type=\"paired\")\nplot(power$n,power$power)\nabline(h=0.8)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nn=196ã®ã¨ãã®æ¤œå‡ºåŠ›\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 196\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\npower <- power.t.test(n = n, delta = delta, sd=sd, sig.level = alpha,type=\"paired\")\npower$power\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7956606\n```\n:::\n:::\n\n\n## ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®è¨ˆç®—\n\n### å‰²åˆã®å·®ã®æ¤œå®š(ã‚«ã‚¤2ä¹—æ¤œå®š)\n\n$$\nn=\\frac{\\{Z(\\alpha/2)\\sqrt{2\\overline{p}(1-\\overline{p})}+Z(\\beta)\\sqrt{p_0(1-p_0)+p_1(1-p_1)}\\}^2}{d^2}\n$$\n\n$$\n\\overline{p}=(p_0+p_1)/2\n$$\n\n#### ç¬¬ä¸€ç¾¤ã®æ¯æ¯”çŽ‡ð‘0=100E-6ã€ç¬¬äºŒç¾¤ã®æ¯æ¯”çŽ‡ð‘1=500E-6ã€ç¬¬ä¸€ã®éŽèª¤ð›¼=0.05ã€æ¤œå‡ºåŠ›0.8ã¨ã—ãŸã¨ãã®ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalpha <- 0.05\np0 <- 100E-6\np1 <- 500E-6\npower<-0.8\nbeta<-1-power\nphat<-(p0+p1)/2\n((-qnorm(alpha/2)*sqrt(2*phat*(1-phat))+(-qnorm(beta)*sqrt(p0*(1-p0)+p1*(1-p1))))^2)/((p1-p0)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 29423.29\n```\n:::\n:::\n\n\n\n\n### å¯¾å¿œã®ãªã„tæ¤œå®šã®ã¨ãã®ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º\n\nä¸‹è¨˜ã§è¨ˆç®—ã™ã‚‹\n\n$$\nn=\\frac{2\\sigma^2\\{Z(\\alpha/2)+Z(\\beta)\\}^2}{d^2}\n$$\n\n#### æ¨™æº–åå·®0.05, æ¤œå‡ºã™ã¹ãå·®ã‚’0.01,æ¤œå‡ºåŠ›0.8ã€$\\alpha$ã‚’ä¸¡å´5%ã€æ¤œå‡ºåŠ›$1-\\beta$ã‚’80%ã¨ã—ãŸå ´åˆ\n\n\n::: {.cell}\n\n```{.r .cell-code}\npower<-0.8\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\n(2*(sd^2)*(-qnorm(alpha/2)+(-qnorm(1-power)))^2)/(delta^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 392.444\n```\n:::\n:::\n\n\n\n### å¯¾å¿œã®ã‚ã‚‹tæ¤œå®šã®ã¨ãã®ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º\n\nä¸‹è¨˜ã§è¨ˆç®—ã™ã‚‹\n\n$$\nn=\\frac{\\sigma^2\\{Z(\\alpha/2)+Z(\\beta)\\}^2}{d^2}\n$$\n\n#### æ¨™æº–åå·®0.05, æ¤œå‡ºã™ã¹ãå·®ã‚’0.01,æ¤œå‡ºåŠ›0.8ã€$\\alpha$ã‚’ä¸¡å´5%ã€æ¤œå‡ºåŠ›$1-\\beta$ã‚’80%ã¨ã—ãŸå ´åˆ\n\n\n::: {.cell}\n\n```{.r .cell-code}\npower<-0.8\nalpha <- 0.05\ndelta <- 0.01\nsd <- 0.05\n((sd^2)*(-qnorm(alpha/2)+(-qnorm(1-0.8)))^2)/(delta^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 196.222\n```\n:::\n:::\n\n\n## å‚è€ƒæ–‡çŒ®\n\n- [Rè¨€èªžã€€æ¤œå‡ºåŠ›ãƒ»ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã€€tæ¤œå®šã‚„æ¯æ¯”çŽ‡ã®æ¤œå®šã®æ¤œå‡ºåŠ›ã®è¨ˆç®—](https://multivariate-statistics.com/2021/10/16/r-programming-power-sample-size/)\n- [ã€pythonã§çµ±è¨ˆå­¦ã€‘çµ±è¨ˆæ¤œå®šã®ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã‚’è¨ˆç®—ã™ã‚‹](https://python-man.club/sample_size/)\n- [ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã®è¨­è¨ˆ](https://iss.ndl.go.jp/books/R100000002-I000011064467-00)\n- [power.t.test() : 1ç¾¤ã¾ãŸã¯2ç¾¤ã®tæ¤œå®šã®ãƒ‘ãƒ¯ãƒ¼è¨ˆç®—ã‚’ã™ã‚‹é–¢æ•°](https://clover.fcg.world/2016/06/15/5302/)\n\n## R version\n\n\n::: {.cell}\n\n```{.r .cell-code}\nR.version.string\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"R version 4.3.0 (2023-04-21)\"\n```\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}